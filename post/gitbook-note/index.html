<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta content="yes" name="apple-mobile-web-app-capable" />
<meta content="black" name="apple-mobile-web-app-status-bar-style" />
<meta name="referrer" content="never">
<meta name="keywords" content="">
<meta name="description" content="欢迎访问[鼓捣猫宁]的个人博客">
<meta name="author" content="kveln">
<title>GitBook搭建及配置 | 鼓捣猫宁</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css">
<link href="https://cdn.bootcss.com/font-awesome/5.11.2/css/all.min.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
<link
  href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800'
  rel='stylesheet' type='text/css'>
<link rel="alternate" type="application/rss+xml" title="GitBook搭建及配置 | 鼓捣猫宁 » Feed"
  href="https://daning.netlify.app/atom.xml">
<link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.15.10/build/styles/androidstudio.min.css">
<link href="https://daning.netlify.app/styles/main.css" rel="stylesheet">
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets/highlight.min.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/850552586/ericamcdn@0.1/css/live2d.css">

<script>hljs.initHighlightingOnLoad();</script>

  <meta property="og:description" content="GitBook搭建及配置" />
  <meta property="og:url" content="https://daning.netlify.app/post/gitbook-note/" />
  <meta property="og:locale" content="zh-CN" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="鼓捣猫宁" />
  <!-- <script src="../assets/styles/scripts/tocScript.js"></script> -->
</head>

<body>
  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand" href="https://daning.netlify.app">鼓捣猫宁</a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
      data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false"
      aria-label="Toggle navigation">
      Menu
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ml-auto">
        
        <li class="nav-item">
          
          <a class="nav-link" href="/">首页</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="/archives">归档</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="/tags">标签</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="/about">关于</a>
          
        </li>
        
        <li class="nav-item">
          <div class="gridea-search-container">
            <form id="gridea-search-form" style="position: relative" data-update="1770892703131"
              action="/search/index.html">
              <input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="搜索文章" />
              <i class="fas fa-search gt-c-content-color-first" style="position: absolute; top: 9px; left: 10px;"></i>
            </form>
          </div>
        </li>
      </ul>
    </div>
  </div>
</nav>
  <!-- Page Header -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand" href="https://daning.netlify.app">鼓捣猫宁</a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
      data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false"
      aria-label="Toggle navigation">
      Menu
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ml-auto">
        
        <li class="nav-item">
          
          <a class="nav-link" href="/">首页</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="/archives">归档</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="/tags">标签</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link" href="/about">关于</a>
          
        </li>
        
        <li class="nav-item">
          <div class="gridea-search-container">
            <form id="gridea-search-form" style="position: relative" data-update="1770892703131"
              action="/search/index.html">
              <input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="搜索文章" />
              <i class="fas fa-search gt-c-content-color-first" style="position: absolute; top: 9px; left: 10px;"></i>
            </form>
          </div>
        </li>
      </ul>
    </div>
  </div>
</nav>
<header class="masthead" style="background-image: url('https://daning.netlify.app/media/images/home-bg.jpg')">
  <div class="overlay"></div>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-md-10 mx-auto">
        
          <!-- 没Title为其他页面Header -->
          
            <!-- 没Title并且有headerType为Post：文章Header -->
            <div class="post-heading">
              <span class="tags">
                
                <a href="https://daning.netlify.app/tag/zL-xmZeUD/" class="tag">GitBook</a>
                
                <a href="https://daning.netlify.app/tag/VYkxi25Yw/" class="tag">Tool</a>
                
              </span>
              <h1>GitBook搭建及配置</h1>
              <span class="meta">
                Posted on
                2020-05-15，7 min read
              </span>
            </div>
          
        
      </div>
    </div>
  </div>
</header>
  <!-- Post Content -->
  <article id="post-content-article">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto post-content-container">
          
          <p>使用Jekyll去搭建SDK文档的网站虽然自由度高，但是想支持的非常好需要很娴熟的html技能；<br><br>
GitBook有固定好的框架，非常适合书写SDK文档。</p>
<!-- more -->
<h1 id="1-gitbook简介">1 GitBook简介</h1>
<ul>
<li><a href="https://www.gitbook.com">GitBook官网</a></li>
<li><a href="https://github.com/GitbookIO/gitbook">GitBook文档</a></li>
</ul>
<h1 id="2-gitbook本地创建步骤">2 GitBook本地创建步骤</h1>
<ol>
<li>
<p>创建好指定目录后，在该目录下执行 <code>gitbook init</code><br><br>
首次init后，会自动生成README.md 和 SUMMARY.md 这两个文件；README就是说明文档，而SUMMARY其实就是页面的目录结构</p>
</li>
<li>
<p>这时候其实就已经完成了初创GitBook了，接下来输入 <code>gitbook serve</code> 命令，就可以直接拉起 <code>http://localhost:4000</code> 本地serve，在浏览器可以直接展示</p>
</li>
<li>
<p>接下来便可以针对此GibBook增加配置了，配置信息要放在 <code>book.json</code>里，例如：</p>
<pre><code class="language-shell">{
    &quot;title&quot;: &quot;LinkPlay SDK&quot;, #本书标题
    &quot;author&quot;: &quot;LinkPlay&quot;, #本书作者
    &quot;description&quot;: &quot;LinkPlay SDK 文档&quot;, #本书描述
    &quot;language&quot;: &quot;zh-hans&quot;, #本书语言，中文设置 &quot;zh-hans&quot; 即可
    &quot;styles&quot;: {
        &quot;website&quot;: &quot;./styles/website.css&quot; #自定义页面样式
    },
    &quot;structure&quot;: {
        &quot;readme&quot;: &quot;README.md&quot; #指定Readme、Summary、Glossary和Languages对应的文件名
    },
    &quot;plugins&quot;: [ #配置使用的插件
        &quot;-sharing&quot;, #自带插件，前面加减号可以禁用
        &quot;github&quot;,
        &quot;-livereload&quot; #热加载，自带插件，强烈建议删除，如果开放然后查看其代码，会发现其端口号为35729，和网站上常用的80端口号不同；本地用着很爽，但是网页加载很慢，浏览器Title会转很久
      ],
      &quot;pluginsConfig&quot;: { #配置插件的属性
        &quot;github&quot;: {
          &quot;url&quot;: &quot;https://github.com/linkplayapp/linkplay_sdk_doc&quot;
        },
      }
}
</code></pre>
</li>
<li>
<p>如果book.json配置中包含plugins，那么在重新 <code>gitbook serve</code> 前需要先 <code>gitbook install</code> ，安装对应的插件，实际上就是用npm去install</p>
</li>
<li>
<p>接下来就可以配置页面的目录结构，修改 <code>SUMMARY.md</code> ，便可达到修改目录的作用，例：</p>
</li>
</ol>
<pre><code class="language-markdown">  # Summary
  * [介绍](README.md)
  * [iOS](iOS/README.md) &lt;!-- 如果把md中的文档在左侧显示目录，可以拼接(#标题名) --&gt;
      * [Device_SDK](iOS/Device_SDK.md#标题1)
      * [Device_SDK](iOS/Device_SDK.md#标题2)
  * [Android](android/README.md)
      * [测试](android/Test.md)
</code></pre>
<h1 id="3-github上配套搭建环境">3 Github上配套搭建环境</h1>
<ol>
<li>先创建个仓库，然后clone至本地，并将上面步骤生成的代码全部copy到该目录下</li>
<li>最好还是gitignore掉node_modules文件夹，然后将代码push到master上;(记得把_book文件夹备份一下，接下来会用到)</li>
<li>然后创建gh-pages分支，命名最好如此，默认的规则，不然以后Gitbook链接会受到不定影响<pre><code class="language-shell">git checkout -b gh-pages
</code></pre>
</li>
<li>在gh-pages分支下，先清空文件夹，将第2步准备好的_book里的所有内容copy到当前目录下（注意是copy _book文件下的所有子项，而不是仅仅把文件夹拷贝）</li>
<li>此时可以提交了</li>
<li>访问自己这个库的github地址，然后到setting里面<br>
<img src="https://s1.ax1x.com/2020/09/07/wudgXD.png" alt="Setting" loading="lazy"></li>
<li>找到options下面的github pages下的二级域名，这就是此gitbook的地址<br>
<img src="https://s1.ax1x.com/2020/09/07/wudc6O.png" alt="Setting" loading="lazy"></li>
</ol>
<h1 id="4-faq">4 FAQ</h1>
<h2 id="1-为什么要创建gh-pages分支">1 为什么要创建gh-pages分支？</h2>
<blockquote>
<p>gitbook serve时，本地会生成_book文件夹，里面就是网站的静态资源文件，其中index.html就是网站的入口；<br><br>
github pages的原理是加载html的静态资源文件，所以只要让github pages加载_book这个文件夹就可以实现gitbook网站的展示；<br><br>
但是由于_book里的静态资源是在_book的文件夹里的，所以要新建一个分支，间接删掉_book这一层，直接将其下的资源文件放在分支里。<br><br>
因此我们创建了gh-pages分支，并且把master下_book的内容全部copy到该分支下，这样就可以实现网站展示了；</p>
</blockquote>
<h2 id="2-为什么gitbook展示的是gh-pages分支而不是master分支">2 为什么Gitbook展示的是gh-pages分支，而不是master分支？</h2>
<blockquote>
<p>我猜是由于github有自动检测的机制，发现master分支下没有index.html，但是gp-pages分支根目录下却有index.html，所以默认gh-pages为github pages 访问的分支。当然也可以自己手动更改：</p>
</blockquote>
<figure data-type="image" tabindex="1"><img src="https://s1.ax1x.com/2020/09/07/wuw4rF.png" alt="Setting" loading="lazy"></figure>
<h2 id="3-有没有好的方法避免每次手动copy-_book下文件">3 有没有好的方法避免每次手动copy _book下文件</h2>
<ul>
<li>
<p>第一种： 可以用jenkins：由master去监控master分支，轮询或者监听方式具体不了解，以此来实现每次master有变化，就去自动切换到gh-pages分支，copy master分支的_book资源文件</p>
</li>
<li>
<p>第二种： 写了个脚本，将步骤缩减至2步；</p>
<ol>
<li>切换至gh-pages</li>
<li>执行脚本</li>
</ol>
</li>
<li>
<p>脚本具体步骤：</p>
<ol>
<li>git fetch 、 git rebase <code>保证gh-pages分支为最新</code></li>
<li>git checkout master -- _book <code>把master下_book拉到当前分支下</code></li>
<li>递归遍历_book，把子文件全部覆盖至当前目录</li>
<li>删除_book</li>
<li>git add .</li>
<li>git commit -m 'Update by <strong>当前时间</strong>'</li>
<li>git push origin gh-pages <code>提交代码</code></li>
<li>git checkout master <code>切换回master分支</code></li>
</ol>
</li>
<li>
<p>例：</p>
</li>
</ul>
<pre><code class="language-python">import os
import shutil
import datetime

print(&quot;*** gf &amp;&amp; gr&quot;)
os.system(&quot;git fetch&quot;)
os.system(&quot;git rebase&quot;)

print(&quot;*** Copy from master's _book ***&quot;)
os.system(&quot;git checkout master -- _book&quot;)

target_path = os.getcwd()
book_path = os.path.join(target_path, &quot;_book&quot;)
if(os.path.exists(book_path)):
    print(&quot;*** Start copy ***&quot;)
    for a in os.walk(book_path):
        # 递归创建目录
        for d in a[1]:
            dir_path = os.path.join(a[0].replace(book_path, target_path), d)
            if not os.path.isdir(dir_path):
                # 不存在就创建
                os.makedirs(dir_path)
        # 递归拷贝文件
        for f in a[2]:
            dep_path = os.path.join(a[0], f)  # _book 目录下的每个文件的绝对路径
            arr_path = os.path.join(a[0].replace(
                book_path, target_path), f)  # 每个文件的目标路径
            shutil.copy(dep_path, arr_path)
    print(&quot;*** Copy end ***&quot;)
    shutil.rmtree('_book')
    print(&quot;*** Remove _book ***&quot;)
    print(&quot;*** Push... ***&quot;)
    os.system(&quot;git add .&quot;)
    now = datetime.datetime.now()
    commitMessage = &quot;Update by %d-%02d-%02d %02d:%02d:%02d&quot; % (now.year,now.month,now.day,now.hour,now.minute,now.second)
    commitCode = &quot;git commit -m '%s'&quot; % commitMessage
    os.system(commitCode)
    os.system(&quot;git push origin gh-pages&quot;)
    print(&quot;*** Checkout master... ***&quot;)
    os.system(&quot;git checkout master&quot;)
else:
    print(&quot;*** _book is not exists*** &quot;)

</code></pre>

          <div class="toc-container"><ul class="markdownIt-TOC">
<li><a href="#1-gitbook%E7%AE%80%E4%BB%8B">1 GitBook简介</a></li>
<li><a href="#2-gitbook%E6%9C%AC%E5%9C%B0%E5%88%9B%E5%BB%BA%E6%AD%A5%E9%AA%A4">2 GitBook本地创建步骤</a></li>
<li><a href="#3-github%E4%B8%8A%E9%85%8D%E5%A5%97%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83">3 Github上配套搭建环境</a></li>
<li><a href="#4-faq">4 FAQ</a>
<ul>
<li><a href="#1-%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%88%9B%E5%BB%BAgh-pages%E5%88%86%E6%94%AF">1 为什么要创建gh-pages分支？</a></li>
<li><a href="#2-%E4%B8%BA%E4%BB%80%E4%B9%88gitbook%E5%B1%95%E7%A4%BA%E7%9A%84%E6%98%AFgh-pages%E5%88%86%E6%94%AF%E8%80%8C%E4%B8%8D%E6%98%AFmaster%E5%88%86%E6%94%AF">2 为什么Gitbook展示的是gh-pages分支，而不是master分支？</a></li>
<li><a href="#3-%E6%9C%89%E6%B2%A1%E6%9C%89%E5%A5%BD%E7%9A%84%E6%96%B9%E6%B3%95%E9%81%BF%E5%85%8D%E6%AF%8F%E6%AC%A1%E6%89%8B%E5%8A%A8copy-_book%E4%B8%8B%E6%96%87%E4%BB%B6">3 有没有好的方法避免每次手动copy _book下文件</a></li>
</ul>
</li>
</ul>
</div>
          
          <hr />
          <p class="next-post">下一篇：
            <a href="https://daning.netlify.app/post/xcode-localizaions/">
              <span class="post-title">
                iOS给项目添加多语种&rarr;
              </span>
            </a>
          </p>
          
          <div class="comment" style="text-align: center;">
            
            <span id="/post/gitbook-note/" class="leancloud_visitors"
              data-flag-title="GitBook搭建及配置">
              <em class="post-meta-item-text">阅读量 </em>
              <i class="leancloud-visitors-count">loading...</i>
            </span>
            

            
            
            <script src='https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js'></script>

<style>
	div#vcomments{
		width:100%;
		max-width: 1000px;
		padding: 2.5%
	}
</style>


	<div id="vcomments"></div>

<script>
	new Valine({
		el: '#vcomments',
		appId: 'MAAasDLv2NYMtEEAn4QnnU3l-gzGzoHsz',
		appKey: 'dISXAmwDUYme6vJqsc5HgYw1',
		avatar: 'robohash',
		pageSize: 5,
		recordIp: false,
		placeholder: '来都来了，不留下点虎狼之词就走吗？',
		visitor: true,
	});
</script>

            
          </div>
        </div>
      </div>
  </article>
  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">
          <ul class="list-inline text-center">
            
            
            <li class="list-inline-item">
              <a href="https://github.com/NeedQuiet" target="_blank">
                <span class="fa-stack fa-lg">
                  <i class="fas fa-circle fa-stack-2x"></i>
                  <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                </span>
              </a>
            </li>
            
              
            
              
            
              
            
            <li class="list-inline-item">
              <a href="https://www.zhihu.com/people/da-ning-40" target="_blank">
                <span class="fa-stack fa-lg">
                  <i class="fas fa-circle fa-stack-2x"></i>
                  <i class="fab fa-zhihu fa-stack-1x fa-inverse"></i>
                </span>
              </a>
            </li>
            
              
            
              
            
              
            
              
              <!-- <li class="list-inline-item">
              <a href="https://daning.netlify.app/atom.xml" target="_blank">
                <span class="fa-stack fa-lg">
                  <i class="fas fa-circle fa-stack-2x"></i>
                  <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
                </span>
              </a>
              </li> -->
          </ul>
          <p class="copyright text-muted">Copyright &copy;<span>鼓捣猫宁</span><br><a href="https://github.com/getgridea/gridea" class="Themeinfo">Powered by Gridea</a></p>
        </div>
      </div>
    </div>
   </footer>
  <!-- Bootstrap core JavaScript -->
  <script src="https://cdn.bootcss.com/twitter-bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
  <!-- <script src="https://daning.netlify.app/media/scripts/bootstrap.bundle.min.js"></script> -->
  <!-- Bootstrap core JavaScript -->
  <script src="https://cdn.jsdelivr.net/gh/Alanrk/clean-cdn@1.0/scripts/clean-blog.min.js"></script>
  <!-- <script src="https://daning.netlify.app/media/scripts/clean-blog.min.js"></script> -->
  <script src="//instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
  <style type="text/css">a.back_to_top{text-decoration:none;position:fixed;bottom:40px;right:30px;background:#f0f0f0;height:40px;width:40px;border-radius:50%;line-height:36px;font-size:18px;text-align:center;transition-duration:.5s;transition-propety:background-color;display:none}a.back_to_top span{color:#888}a.back_to_top:hover{cursor:pointer;background:#dfdfdf}a.back_to_top:hover span{color:#555}@media print,screen and(max-width:580px){.back_to_top{display:none!important}}</style>
<a id="back_to_top" href="#" class="back_to_top">
  <span>▲</span></a>
<script>$(document).ready((function(_this) {
    return function() {
      var bt;
      bt = $('#back_to_top');
      if ($(document).width() > 480) {
        $(window).scroll(function() {
          var st;
          st = $(window).scrollTop();
          if (st > 30) {
            return bt.css('display', 'block')
          } else {
            return bt.css('display', 'none')
          }
        });
        return bt.click(function() {
          $('body,html').animate({
            scrollTop: 0
          },
          800);
          return false
        })
      }
    }
  })(this));</script>
  
  <div id="landlord-parent">
    <div id="landlord">
        <div class="message" style="opacity:0"></div>
        <canvas id="live2d" width="240" height="250" class="live2d"></canvas>
    </div>
</div>

<script type="text/javascript">
    if (/(iPhone|iPad|iPod|iOS|Android)/i.test(navigator.userAgent)) {
        //移动端
        console.log("------ 移动端");
    } else {
        console.log("------ PC端 " + navigator.userAgent);

        addScript("https://cdn.jsdelivr.net/gh/850552586/ericamcdn@0.1/js/live2d.js", () => {
            // 加载完成后再loadlive2d
            loadlive2d("live2d", "https://daning.netlify.app/media/live2d/assets/hijiki.model.json");
        });

        var home_Path = "https://daning.netlify.app/";
        addScript("https://daning.netlify.app/media/live2d/js/message.js", () => { });
    }

    // 插入js文件，完成后callback
    function addScript(jsfile, callback) {
        var landlord_parent = document.getElementById("landlord-parent");
        var script = document.createElement("script");
        script.type = "text/javascript";
        script.src = jsfile;
        landlord_parent.appendChild(script);
        script.onload = script.onreadystatechange = function () {
            if (!this.readyState || this.readyState === "loaded" || this.readyState === "complete") {
                script.onload = script.onreadystatechange = null;
                if (callback && typeof callback == "function") {
                    callback(); //window[callback]();如果传递字符串过来 调用window['函数名']() 调用方法
                }
            }
        };
    }
</script>
  
  <script src="https://daning.netlify.app/media/scripts/tocScript.js"></script>
</body>

</html>